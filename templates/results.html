<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Recommendations Results</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
        .container {
            padding: 2rem;
        }

        .slider-wrapper {
            position: relative;
            max-width: 48rem;
            margin: 0 auto;
        }

        .slider {
            display: flex;
            aspect-ratio: 16/9;
            overflow-x: hidden;
            scroll-snap-type: x mandatory;
            scroll-behavior: smooth;
            box-shadow: 0 1.5rem 3rem -0.75rem hsla(0, 0%, 0%, 0.25);
            border-radius: 0.5rem;
        }

        .slider img {
            flex: 1 0 100%;
            scroll-snap-align: start;
            object-fit: cover;
        }

        .slider-nav {
            display: flex;
            column-gap: 0.5rem;
            position: absolute;
            bottom: 0.5rem;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1;
        }

        .slider-nav a {
            width: 1rem;
            height: 1rem;
            border-radius: 50%;
            background-color: #111;
            opacity: 0.5;
            transition: opacity 250ms, background-color 250ms;
            display: inline-block;
            cursor: pointer;
        }

        .slider-nav a.active {
            opacity: 1;
            background-color: #000;
        }
        
    </style>
</head>
<body>
    <h1>Recommendations</h1>
    <p><strong>Media:</strong> {{ media }}</p>
    <p><strong>Content:</strong> {{ content }}</p>
    <h2>Recommended Items:</h2>
    <ul>
        {% for item in recommendations.split('\n') %}
            <li>{{ item.strip() }}</li>
        {% endfor %}
    </ul>

    <!--Check if the media is music-->
    {% if media.lower() == 'music' %}
    <h2>Music Details</h2>
    <ul>
        <!--Iterate through each track names-->
        {% for track_name, track_id in track_ids.items() %}
            <li>
                <iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/{{ track_id }}?utm_source=generator" width="100%" height="352" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
            </li>
        {% endfor %}
    </ul>
    {% endif %}

    {% if media.lower() == 'movie' %}
    <h2>Movie Trailers</h2>
    <ul>
        {% for link in trailers %}
            <li>
                <iframe width="560" height="315" src="{{ link }}" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </li>
        {% endfor %}
    </ul>
    {% endif %}

    {% if media.lower() == 'game' %}
    <h2>Game Images</h2>
    <table>
        {% for game_name, album in games.items() %}
            {% if album %}
            <tr>
                <th>{{ game_name }}</th>
            </tr>
            <tr>
                <td>
                    <section class ="container">
                        <div class="slider-wrapper">
                            <div class="slider">
                                {% for pic in album %}
                                    <img id="slide-{{ game_name }}{{ loop.index0 }}" src="{{ pic }}" alt="Pic">
                                {% endfor %}
                            </div>
                            <div class="slider-nav">
                                {% for pic in album %}
                                    <a data-slide="{{ loop.index0 }}"></a>
                                {% endfor %}
                            </div>
                        </div>
                    </section>
                    
                </td>
            </tr>
            {% endif %}
        {% endfor %}
    </table>
    {% endif %}
    <!--Go back home-->
    <a href="{{ url_for('index') }}">Back to Home</a>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const sliders = document.querySelectorAll('.slider-wrapper');

            sliders.forEach(sliderWrapper => {
                const slider = sliderWrapper.querySelector('.slider');
                const navDots = sliderWrapper.querySelectorAll('.slider-nav a');

                navDots.forEach(dot => {
                    dot.addEventListener('click', function(event) {
                        event.preventDefault(); // Prevent default anchor behavior
                        const slideIndex = dot.getAttribute('data-slide');
                        slider.scrollTo({
                            left: slider.clientWidth * slideIndex,
                            behavior: 'smooth'
                        });

                        // Update active class
                        navDots.forEach(d => d.classList.remove('active'));
                        dot.classList.add('active');
                    });
                });
            });
        });
    </script>
</body>
</html>
